<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Predicting U.S. Soybean Yield with Climate Data | Wenwen Kong </title> <meta name="author" content="Wenwen Kong"> <meta name="description" content="An end-to-end machine learning project on U.S. soybean yield prediction"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wenwenkong.github.io/blog/2025/us-soybean-prediction/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">
      {
            "title": "Predicting U.S. Soybean Yield with Climate Data",
            "description": "An end-to-end machine learning project on U.S. soybean yield prediction",
            "published": "March 11, 2025",
            "authors": [
              
              {
                "author": "Wenwen Kong",
                "authorURL": "",
                "affiliations": [
                  {
                    "name": "",
                    "url": ""
                  }
                ]
              }
              
            ],
            "katex": {
              "delimiters": [
                {
                  "left": "$",
                  "right": "$",
                  "display": false
                },
                {
                  "left": "$$",
                  "right": "$$",
                  "display": true
                }
              ]
            }
          }
    </script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Wenwen</span> Kong </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">Research </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Notes </a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">Teaching </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Predicting U.S. Soybean Yield with Climate Data</h1> <p>An end-to-end machine learning project on U.S. soybean yield prediction</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div> <a href="#summary">Summary</a> </div> <div> <a href="#introduction">Introduction</a> </div> <div> <a href="#data">Data</a> </div> <div> <a href="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a> </div> <div> <a href="#feature-selection">Feature Selection</a> </div> <div> <a href="#model-development">Model Development</a> </div> <ul> <li> <a href="#cross-validation">Cross-validation</a> </li> <li> <a href="#model-selection">Model selection</a> </li> <li> <a href="#hyperparameter-tuning">Hyperparameter tuning</a> </li> <li> <a href="#feature-importance">Feature importance</a> </li> </ul> <div> <a href="#inference-and-deployment">Inference and Deployment</a> </div> <div> <a href="#caveats-and-future-work">Caveats and Future Work</a> </div> <div> <a href="#references">References</a> </div> </nav> </d-contents> <h2 id="summary">Summary</h2> <p>This post walks through my end-to-end machine learning project on predicting U.S. soybean annual yield based on local climate conditions. We cover all key steps of a machine learning workflow, including ideation, feature selection, cross validation, baseline modeling, hyperparameter tuning, and model deployment. We employed annual soybean yield data and monthly climate variables during the historical period from 1981 to 2016. The model was trained on annual soybean yield data and monthly climate variables from 1981 to 2015, with 2016 used as the test set. We found that XGBRegressor performed the best among the regression algorithms (including linear and tree-based models) tested in this project. Our model achieved an \(R^2\) of ~0.9, demonstrating a strong ability to predict U.S. soybean annual yield based on climate conditions. Please refer to <a href="https://github.com/wenwenkong/data-science-portfolio/tree/main/US_soybean_yield" rel="external nofollow noopener" target="_blank">this repo</a> for the project’s code.</p> <hr> <h2 id="introduction">Introduction</h2> <p>Soybean is a vital source of protein for both human and animal nutrition, but its yield is highly sensitive to weather and climate variability. High temperatures and low soil moisture, particularly during the summer reproductive period, can significantly reduce soybean yields (Hamed et al., 2021). Early-season excessive precipitation can also negatively impact soybean yields by restricting root development, causing nutrient leaching, and increasing disease susceptibility (Ortiz-Bobea et al., 2019).</p> <p>This project is motivated by two questions:</p> <ol> <li>Can we build a machine learning model that predicts local annual soybean yield in the United States based on local climate conditions?</li> <li>Which climatic factors contribute most to the soybean yield prediction?</li> </ol> <p><strong>Figure 1</strong> (<a href="https://www.codecademy.com/article/deep-learning-workflow" rel="external nofollow noopener" target="_blank">source</a>) illustrates the life cycle of a typical end-to-end machine learning project, which consists of four main components: data preparation, feature selection, model training, and deployment. We closely followed this framework throughout the project.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_1_ML_Workflow-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_1_ML_Workflow-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_1_ML_Workflow-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_1_ML_Workflow.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 1.</b> Life cycle of an end-to-end machine learning project. </div> <p>The reminder of the post is structured as follows. We first introduce the dataset and conduct an exploratory data analysis to examine the temporal and spatial patterns of the historical U.S. soybean yield. We then describe the feature selection process that constructed the training dataset. The model training section covers key aspects of model development. Finally, we discuss the deployment process and conclude with an overview of caveats and potential directions for future work.</p> <hr> <h2 id="data">Data</h2> <p>We focused on two datasets: one for soybean yield and the other for climate variables. Historical annual soybean yield was provided by the Global Dataset of Historical Yields (GDHY) (lizumi and Sakai, 2020), where crop yield is defined as production per unit harvested area (\(t\) \(ha^{-1}\)). For climate variables, we used monthly model outputs from the North American Land Data Assimilation System (NLDAS) (Mitchell et al. 2004). The NLDAS dataset provides near-surface climate variables, including surface energy fluxes, surface water flux and storage, soil moisture, temperature, and land surface parameters. Both GDHY and NLDAS are land-based datasets, meaning that values over the ocean appear as NaNs. We focus on the period 1981-2016, covering the spatial domain \(235.25^{\circ} - 292.75^{\circ}E, 25.25^{\circ} - 52.75^{\circ}N\), which encompasses the primary continental regions in the U.S.</p> <hr> <h2 id="exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</h2> <p>To better understand U.S. soybean production, we conducted an exploratory data analysis (<strong>Figures 2-5</strong>). The majority of soybean production is concentrated in the eastern and midwestern states, while the Great Plains region has relatively lower production density (<strong>Figure 2</strong>). To complement this spatial view, <strong>Figure 3</strong> presents a boxplot of the interquartile range (IQR) across all soybean production grid points for each year, highlighting spatial variations in yield Both local soybean yield and its spatial spread exhibit year-to-year variability (<strong>Figures 2-3</strong>).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_2_GDHY_Soybean_4yrs-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_2_GDHY_Soybean_4yrs-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_2_GDHY_Soybean_4yrs-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_2_GDHY_Soybean_4yrs.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 2.</b> Soybean annual yield (unit: \(t\) \(ha^{-1}\)) in the U.S. for four years. </div> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_3_GDHY_Box-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_3_GDHY_Box-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_3_GDHY_Box-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_3_GDHY_Box.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 3.</b> Boxplot of the U.S. soybean annual yield for each year. </div> <p>Statistical analysis reveals that U.S. soybean annual yield follows a bimodal distribution (<strong>Figure 4</strong>), suggesting that not all soybean-producing regions behave uniformly. We hypothesize that this bimodal pattern arises from differences between high-production areas (Midwestern and Eastern states) and lower-production areas (Great Plains) The left mode of the distribution likely corresponds to the Great Plains, while the right mode represents more densely cultivated regions.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_4_GDHY_PDF-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_4_GDHY_PDF-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_4_GDHY_PDF-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_4_GDHY_PDF.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 4.</b> Probability Density Function of the U.S. soybean annual yield from 1981 to 2016. </div> <p>Both climatology and long-term trends display a west-east dipole pattern, further the Great Plains apart from other areas(<strong>Figure 5</strong>). Climatologically, soybean yield is lower in the Great Plains compared to other regions. The long-term trend, however, highlights the Great Plains as a hotspot area that experienced notable increase in soybean yield from 1981 to 2016. The overall increasing trend in the U.S. Soybean yield aligns with what we observed in <strong>Figure 3</strong>.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_5_GDHY_climatology_trend-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_5_GDHY_climatology_trend-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_5_GDHY_climatology_trend-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_5_GDHY_climatology_trend.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 5.</b> (Left) Climatology and (Right) trend of the U.S. soybean annual yield. </div> <p>In this project, we train a unified model for all soybean production regions across the U.S. This approach assumes that the causal relationship between local climate conditions and soybean yield is consistent across all soybean production regions. We acknowledge that this is an oversimplification and we discuss its limitations in the <code class="language-plaintext highlighter-rouge">Caveats and Future Work</code> section.</p> <p>We merged the GDHY and NLDAS datasets by matching the <code class="language-plaintext highlighter-rouge">lat</code>, <code class="language-plaintext highlighter-rouge">lon</code>, and <code class="language-plaintext highlighter-rouge">year</code> features (see <strong>Figure 6</strong> for a screenshot of the merged dataset; see section 4.1 in <a href="https://github.com/wenwenkong/data-science-portfolio/blob/main/US_soybean_yield/1.0_Data_ingestion.ipynb" rel="external nofollow noopener" target="_blank">this notebook</a>). The resulting DataFrame contains over 600 climate features from NLDAS. We will perform feature selection in the next section.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_6_GDHY_NLDAS_merged_head-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_6_GDHY_NLDAS_merged_head-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_6_GDHY_NLDAS_merged_head-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_6_GDHY_NLDAS_merged_head.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 6.</b> Screenshot of the merged DataFrame of the GDHY (i.e. soybean yield) and NLDAS (i.e. climate variables) datasets. </div> <hr> <h2 id="feature-selection">Feature selection</h2> <p>Feature selection requires critical thinking and iterative analysis, making it the most tedious component of this project. Our goal is to narrow down the climate features to a subset that most likely affect soybean yield. This section outlines our thought process for feature selection. Detailed calculations and reasoning can be found in <a href="https://github.com/wenwenkong/data-science-portfolio/blob/main/US_soybean_yield/2.0_EDA_feature_engineering_selection_OutputsCleared.ipynb" rel="external nofollow noopener" target="_blank">this notebook</a> and <a href="https://github.com/wenwenkong/data-science-portfolio/blob/main/US_soybean_yield/3.0_feature_selection_model_training.ipynb" rel="external nofollow noopener" target="_blank">this notebook</a>.</p> <p><strong>Key considerations for feature selection</strong>:</p> <ul> <li>Feature selection should only be performed using the training dataset to prevent bias in feature and model choice from the test set.</li> <li>Feature selection does not always guarantee improved predictions.</li> <li>Linear and non-linear feature selection methods may yield conflicting results. When this happens, we rely on domain knowledge and our understanding of the problem to make decisions.</li> </ul> <p><strong>Feature selection process</strong></p> <p>We break the feature selection process into two phases:</p> <ul> <li>Phase 1: Initial feature filtering based on correlation analysis and domain knowledge.</li> <li>Phase 2: Further refinement using scikit-learn’s feature selection methods. We used features derived from Phase 1 to build baseline models, and used the refined features from Phase 2 for final model selection (see the <code class="language-plaintext highlighter-rouge">Model Development</code> section).</li> </ul> <p><strong>Phase 1: Initial Filtering</strong></p> <p>We followed these key principles in Phase 1:</p> <ol> <li>Temporal consideration:</li> </ol> <ul> <li>Most U.S. soybeans are planted in May and early June and harvested in late September and October (Source: <a href="https://www.ers.usda.gov/topics/crops/soybeans-oil-crops/oil-crops-sector-at-a-glance/" rel="external nofollow noopener" target="_blank">USDA</a>). Thus, we only consider climate features during months before October, removing November and December variables from the current year.</li> <li>Besides current-year climate, we explored whether past-year climate conditions matter. In particular, we explored past year’s annual total rainfall, past winter’s snowfall, rainfall, and soil moisture.</li> </ul> <ol> <li>Correlation analysis:</li> </ol> <ul> <li>We examined correlation between annual yield and climate features to identify important features. We kept variables with strong correlation with yield, and discarded the rest.</li> <li>Since some relationships between climate and yield are nonlinear, we kept certain features despite weak linear correlations if they were scientifically relevant.</li> </ul> <ol> <li>Redundant feature removal:</li> </ol> <ul> <li>We aggregated (e.g., seasonal averages) climate variables that are highly auto-correlated across months to avoid redundancy.</li> <li>Some climate variables exhibit strong cross-correlations, andi we only kept the most relevant ones.</li> <li>We excluded vegetation and land cover features (such as leaf area index) that directly reflect the yield data during the soybean growing and harvest season.</li> </ul> <ol> <li>Feature engineering: We created new features when necessary. For example, we derived an evaporative fraction using surface energy fluxes and used it instead of latent and sensible heat fluxes to simplify the feature set.</li> </ol> <p><strong>Phase 2: scikit-learn based feature selection methods</strong></p> <p>In Phase 2, we refined the feature set using various scikit-learn methods: <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.VarianceThreshold.html" rel="external nofollow noopener" target="_blank">VarianceThreshold</a>, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_regression.html" rel="external nofollow noopener" target="_blank">f_regression</a>, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.mutual_info_regression.html" rel="external nofollow noopener" target="_blank">mutual_info_regression</a>, <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html" rel="external nofollow noopener" target="_blank">Lasso</a>, and <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.SelectFromModel.html" rel="external nofollow noopener" target="_blank">SelectFromModel</a>. Although typically fewer methods are needed in practical applications, here we experimented with multiple approaches for the sake of practice. More details can be found in <a href="https://github.com/wenwenkong/data-science-portfolio/blob/429f607bb8148e9792c85c149e3f381056ad8346/US_soybean_yield/3.0_feature_selection_model_training.ipynb" rel="external nofollow noopener" target="_blank">this notebook</a>.</p> <hr> <h2 id="model-development">Model Development</h2> <h3 id="cross-validation">Cross-validation</h3> <p><a href="https://machinelearningmastery.com/k-fold-cross-validation/" rel="external nofollow noopener" target="_blank">Cross-validation</a> helps reduce overfitting in machine learning models. While scikit-learn’s train_test_split` method allows for random splitting of data, it is not suitable for our problem due to the sequential nature of the dataset. Instead, we implemented an expanding window backtesting procedure for cross-validation (<strong>Figure 7</strong>). Using this approach, we created a 5-fold split in the training set, ensuring that the test size remained constant across splits for comparability in their performance statistics:</p> <ul> <li>Split 1: train on 1980-2010, test on 2011</li> <li>Split 2: train on 1980-2011, test on 2012</li> <li>Split 3: train on 1980-2012, test on 2013</li> <li>Split 4: train on 1980-2013, test on 2014</li> <li>Split 5: train on 1980-2014, test on 2015</li> </ul> <p>This method ensures that each model is trained on an expanding historical dataset, reflecting real-world forecasting conditions where future predictions are based only on past information.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_7_Expanding-window-cross-validation-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_7_Expanding-window-cross-validation-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_7_Expanding-window-cross-validation-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_7_Expanding-window-cross-validation.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 7.</b> Illustration of the expanding window backtesting concept. Adopted from Uber blog <a href="https://www.uber.com/blog/omphalos/" target="_blank" rel="external nofollow noopener">here</a>. </div> <h3 id="model-selection">Model selection</h3> <p>We first explored both linear models (OLS, Ridge, Lasso) and tree-based models (Decision Tree, Random Forest, XGBoost) to build baseline models. We used both \(R^2\) and RMSE to evaluate model performance. Not surprisingly, tree-based models outperformed linear models, with XGBoost achieving the best performance among the three tree-based models (<strong>Figure 8</strong>).</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_8_Model_selection-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_8_Model_selection-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_8_Model_selection-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_8_Model_selection.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 8.</b> Box plot of \(R^{2}\) values across cross-validation splits from (left) linear regression models and (right) tree-based regression models. </div> <h3 id="hyperparameter-tuning">Hyperparameter tuning</h3> <p>We focused on tuning the following XGBoost hyperparameters to control overfitting:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">n_estimators</code>: Number of rounds for boosting.</li> <li> <code class="language-plaintext highlighter-rouge">learning_rate</code>: Step size shrinkage used in update to prevent overfitting.</li> <li> <code class="language-plaintext highlighter-rouge">colsample_bytree</code>: Subsample ratio of columns when constructing each tree</li> <li> <code class="language-plaintext highlighter-rouge">subsample</code>: Subsample ratio of the training instances.</li> <li> <code class="language-plaintext highlighter-rouge">gamma</code>: Minimum loss reduction required to split a leaf node of the tree; higher values make the algorithm more conservative.</li> <li> <code class="language-plaintext highlighter-rouge">min_child_weight</code>: Minimum sum of instance weights needed in a child; higher values make the algorithm more conservative. -<code class="language-plaintext highlighter-rouge">max_depth</code>: Maximum depth of a tree; higher values increase model complexity and risk of overfitting.</li> <li> <code class="language-plaintext highlighter-rouge">reg_alpha</code>: L1 regularization term on weights; higher values make the model more conservative.</li> </ul> <p>Grid Search, Random Search, and Bayesian Optimization are commonly used hyperparameter tuning methods. We tested both Random Search and Bayesian Optimization (via <a href="https://optuna.readthedocs.io/en/stable/" rel="external nofollow noopener" target="_blank">Optuna</a>). We selected the RandomizedSearchCV-tuned parameters as they produced a slightly higher \(R^2\) value.</p> <h3 id="feature-importance">Feature importance</h3> <p>We used XGBoost’s built-in function to evaluate feature importance (<strong>Figure 9</strong>). Both longitude and year emerge as key features, reflecting the spatial-temporal nature of soybean yield prediction. Longitude serves as a proxy for geographic differences in soybean production, as observed in the EDA, while year likely captures long-term trends affecting yield. Several variables related to soil moisture content also stand out, including spring and summer soil moisture and summertime evaporative fraction. Springtime leaf area index also contributes to yield prediction, likely because it reflects pre-season vegetation health, which could correlate with soil fertility and growing conditions.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_9_XGBoost_feature_importance-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_9_XGBoost_feature_importance-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_9_XGBoost_feature_importance-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_9_XGBoost_feature_importance.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 9.</b> Feature importance chart evaluated based on XGBoost built-in function. </div> <hr> <h2 id="inference-and-deployment">Inference and Deployment</h2> <p>How well does the model perform in 2016 soybean annual yield? <strong>Figure 10</strong> compares the true versus predicted values, suggesting that the model does a decent job in capturing both the spatial pattern and local magnitude of soybean yield. However, the model overall tends to underestimate annual yield c, while overestimating yield in some localized areas. We did not investigate the cause of this underestimation, which could be an area for future analysis. We deployed the trained XGBoost model on AWS EC2, and built a <a href="http://www.ussoybean-demo.com/" rel="external nofollow noopener" target="_blank">web interface</a> using Flask, basic css and javascript.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/posts/us_soybean_yield/fig_10_XGBoost_prediction-480.webp 480w,/assets/img/posts/us_soybean_yield/fig_10_XGBoost_prediction-800.webp 800w,/assets/img/posts/us_soybean_yield/fig_10_XGBoost_prediction-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/posts/us_soybean_yield/fig_10_XGBoost_prediction.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> <b>Figure 10.</b> (Top) Actual value and (Middle) predicted value of the U.S. soybean annual yield for 2016. The bottom plot shows fractional error between the actual and predicted values. </div> <hr> <h2 id="caveats-and-future-work">Caveats and Future Work</h2> <p>In this section, we discuss several limitations of the current approach and potential future improvements.</p> <p><strong>Limited predictors</strong></p> <p>Unlike some other crops (e.g. corn) that are strongly influenced by soil type, drainage, population, row width, tillage and other physical and human factors, soybean yield is more dependent on the natural environment (Source: <a href="https://www.agweb.com/news/crops/soybeans/stack-odds-soybeans-spring" rel="external nofollow noopener" target="_blank">Stack the odds for soybeans this spring</a>). Still, additional factors such as genotype, soil type, and seeding experiments could improve our model’s predictability.</p> <p>In this project, we focused solely on the predictive power of local monthly climate due to the lack of suitable datasets for other predictors. This limitation may have constrained our model’s predictability. Even for the climate data, we relied on a single source (NLDAS). Future work could involve testing alternative datasets that provide both atmospheric and land-based variables to validate or refine our findings.</p> <p><strong>Coarse timescale of crop yield</strong></p> <p>The crop yields data used in this project only provide annual yields, thus we lack information on the timing of soybean planting and seasonal growth cycle at each location and year. Several studies (Colet et al., 2023; Vann and Stokes, 2024) suggest that planting timing affects yield. Future work incorporating sub-annual yield estimates or phenological data could help capture these temporal variations.</p> <p><strong>Localized climate perspective</strong></p> <p>This work takes a localized perspective of climate impacts.hat is, we only considered impacts of local climate on local yield. However, large-scale climate patterns can also affect U.S. soybean yield through teleconnections. For example, El Niño-Southern Oscillation (ENSO) events can impact U.S. growing conditions by synchronizing climate risks across major agricultural regions (Anderson et al., 2018). Including remote climate indices as features could improve our understanding of remote climate influences on soybean yield.</p> <p><strong>Spatial variation</strong></p> <p>As shown in the EDA, U.S. soybean yield varies across the Great Plains, Midwest, and Eastern states. We hypothesize that different sub-regions are governed by different climate factors. Even a common set of climate features is relevant across all regions, their importance may vary by location. Future work could explore training separate models for different sub-regions to improve predictions for local areas.</p> <p><strong>LSTM as an alternative model architecture</strong></p> <p>Long Short-Term Memory (LSTM) networks are well-suited for time-series forecasting tasks. Given the temporal nature of our soybean yield prediction problem, incorporating LSTM in future work could provide valuable insights. Several studies have demonstrated the effectiveness of LSTMs in crop yield prediction (Sun et al, 2019; Bhimavarapu et al., 2023). However, while LSTMs excel at capturing sequential dependencies, they require larger datasets and are more computationally intensive than tree-based models like XGBoost.</p> <hr> <h2 id="references">References</h2> <p><strong>Journal Articles:</strong></p> <ul> <li>Anderson, W., Seager, R., Baethgen, W., &amp; Cane, M. (2018). Trans-Pacific ENSO teleconnections pose a correlated risk to agriculture. Agricultural and Forest Meteorology. <a href="https://doi.org/10.1016/j.agrformet.2018.07.023" rel="external nofollow noopener" target="_blank">https://doi.org/10.1016/j.agrformet.2018.07.023</a> </li> <li>Bhimavarapu, U., Battineni, G., &amp; Chintalapudi, N. (2023). Improved optimization algorithm in LSTM to predict crop yield. Computers, 12(1), 10. <a href="https://doi.org/10.3390/computers12010010" rel="external nofollow noopener" target="_blank">https://doi.org/10.3390/computers12010010</a> </li> <li>Colet, F., Lindsey, A. J., &amp; Lindsey, L. E. (2023). Soybean planting date and seeding rate effect on grain yield and profitability. Agronomy Journal. <a href="https://doi.org/10.1002/agj2.21434" rel="external nofollow noopener" target="_blank">https://doi.org/10.1002/agj2.21434</a> </li> <li>Hamed, M. K., Vogel, M. M., Patricola, C. M., &amp; Seneviratne, S. I. (2021). Impacts of compound hot–dry extremes on US soybean yields. Earth System Dynamics, 12(4), 1371–1386. <a href="https://doi.org/10.5194/esd-12-1371-2021" rel="external nofollow noopener" target="_blank">https://doi.org/10.5194/esd-12-1371-2021</a> </li> <li>Iizumi, T., &amp; Sakai, T. (2020). The global dataset of historical yields for major crops 1981–2016. Scientific Data, 7(1), 97. <a href="https://doi.org/10.1038/s41597-020-0433-7" rel="external nofollow noopener" target="_blank">https://doi.org/10.1038/s41597-020-0433-7</a> </li> <li>Mitchell, K. E., Lohmann, D., Houser, P. R., Wood, E. F., Schaake, J. C., Robock, A., … &amp; Cosgrove, B. A. (2004). The multi-institution North American Land Data Assimilation System (NLDAS): Utilizing multiple GCIP products and partners in a continental distributed hydrological modeling system. Journal of Geophysical Research: Atmospheres, 109(D7), D07S90. <a href="https://doi.org/10.1029/2003JD003823" rel="external nofollow noopener" target="_blank">https://doi.org/10.1029/2003JD003823</a> </li> <li>Ortiz-Bobea, A., Wang, H., Carrillo, C. M., &amp; Ault, T. R. (2019). Unpacking the climatic drivers of U.S. agricultural yields. Environmental Research Letters, 14(6), 064003. <a href="https://doi.org/10.1088/1748-9326/ab1e75" rel="external nofollow noopener" target="_blank">https://doi.org/10.1088/1748-9326/ab1e75</a> </li> <li>Sun, J., Di, L., Sun, Z., Shen, Y., &amp; Lai, Z. (2019). County-level soybean yield prediction using deep CNN-LSTM model. Sensors, 19(20), 4363. <a href="https://doi.org/10.3390/s19204363" rel="external nofollow noopener" target="_blank">https://doi.org/10.3390/s19204363</a> </li> </ul> <p><strong>Online Tutorials &amp; Blog Posts:</strong></p> <ul> <li>Vann, R., &amp; Stokes, D. J. (2024, January). How does soybean planting date impact plant height and soybean yield? NC State Extension. <a href="https://soybeans.ces.ncsu.edu/2024/01/how-does-soybean-planting-date-impact-plant-height-and-soybean-yield/" rel="external nofollow noopener" target="_blank">https://soybeans.ces.ncsu.edu/2024/01/how-does-soybean-planting-date-impact-plant-height-and-soybean-yield/</a> </li> <li>AgWeb. (2024, February). Stack the odds for soybeans this spring. <a href="https://www.agweb.com/news/crops/soybeans/stack-odds-soybeans-spring" rel="external nofollow noopener" target="_blank">https://www.agweb.com/news/crops/soybeans/stack-odds-soybeans-spring</a> </li> <li>XGBoost. (n.d.). XGBoost hyperparameter tuning guide. XGBoost Documentation. <a href="https://xgboost.readthedocs.io/en/stable/tutorials/param_tuning.html" rel="external nofollow noopener" target="_blank">https://xgboost.readthedocs.io/en/stable/tutorials/param_tuning.html</a> </li> <li>XGBoost. (n.d.). XGBoost parameters. XGBoost Documentation. <a href="https://xgboost.readthedocs.io/en/stable/parameter.html" rel="external nofollow noopener" target="_blank">https://xgboost.readthedocs.io/en/stable/parameter.html</a> </li> <li>Amazon Web Services. (n.d.). Tune an XGBoost model in Amazon SageMaker. AWS Documentation. <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/xgboost-tuning.html" rel="external nofollow noopener" target="_blank">https://docs.aws.amazon.com/sagemaker/latest/dg/xgboost-tuning.html</a> </li> <li>Uber. (n.d.). Omphalos: Uber’s point of interest engine for better user experiences. Uber Blog. <a href="https://www.uber.com/blog/omphalos/" rel="external nofollow noopener" target="_blank">https://www.uber.com/blog/omphalos/</a> </li> <li>Towards Data Science. (2020, April). Grid search vs. random search vs. Bayesian optimization. <a href="https://towardsdatascience.com/grid-search-vs-random-search-vs-bayesian-optimization-2e68f57c3c46" rel="external nofollow noopener" target="_blank">https://towardsdatascience.com/grid-search-vs-random-search-vs-bayesian-optimization-2e68f57c3c46</a> </li> <li>Practical Data Science. (n.d.). How to tune an XGBRegressor model with Optuna. <a href="https://practicaldatascience.co.uk/machine-learning/how-to-tune-an-xgbregressor-model-with-optuna" rel="external nofollow noopener" target="_blank">https://practicaldatascience.co.uk/machine-learning/how-to-tune-an-xgbregressor-model-with-optuna</a> </li> </ul> <p><strong>GitHub Repository:</strong></p> <ul> <li>Kong, W. (2022). U.S. soybean yield prediction [GitHub repository]. <a href="https://github.com/wenwenkong/data-science-portfolio/tree/main/US_soybean_yield" rel="external nofollow noopener" target="_blank">https://github.com/wenwenkong/data-science-portfolio/tree/main/US_soybean_yield</a> </li> </ul> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Wenwen Kong. Powered by <a href="http://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Last updated: November 09, 2025. </div> </footer> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>addBackToTop();</script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script>let searchTheme=determineComputedTheme();const ninjaKeys=document.querySelector("ninja-keys");"dark"===searchTheme?ninjaKeys.classList.add("dark"):ninjaKeys.classList.remove("dark");const openSearchModal=()=>{const e=$("#navbarNav");e.hasClass("show")&&e.collapse("hide"),ninjaKeys.open()};</script> <script>const ninja=document.querySelector("ninja-keys");ninja.data=[{id:"nav-about",title:"About",section:"Navigation",handler:()=>{window.location.href="/"}},{id:"nav-research",title:"Research",description:"",section:"Navigation",handler:()=>{window.location.href="/research/"}},{id:"nav-notes",title:"Notes",description:"",section:"Navigation",handler:()=>{window.location.href="/blog/"}},{id:"nav-teaching",title:"Teaching",description:"Courses that I've taught and students that I've mentored.",section:"Navigation",handler:()=>{window.location.href="/teaching/"}},{id:"post-vision-transformer-vit-notes",title:"Vision Transformer (ViT) Notes",description:"Learning notes and mini-implementation of ViT",section:"Posts",handler:()=>{window.location.href="/blog/2025/ViT-notes/"}},{id:"post-genai-with-llms-6-llm-powered-applications",title:"GenAI with LLMs (6) LLM powered applications",description:"Course summary of Generative AI with Large Language Models. Part Six.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-6/"}},{id:"post-genai-with-llms-5-reinforcement-learning-from-human-feedback",title:"GenAI with LLMs (5) Reinforcement learning from human feedback",description:"Course summary of Generative AI with Large Language Models. Part Five.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-5/"}},{id:"post-genai-with-llms-4-parameter-efficient-fine-tuning",title:"GenAI with LLMs (4) Parameter-efficient fine-tuning",description:"Course summary of Generative AI with Large Language Models. Part Four.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-4/"}},{id:"post-genai-with-llms-3-instruction-fine-tuning",title:"GenAI with LLMs (3) Instruction fine-tuning",description:"Course summary of Generative AI with Large Language Models. Part Three.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-3/"}},{id:"post-genai-with-llms-2-pre-training",title:"GenAI with LLMs (2) Pre-training",description:"Course summary of Generative AI with Large Language Models. Part Two.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-2/"}},{id:"post-genai-with-llms-1-fundamentals",title:"GenAI with LLMs (1) Fundamentals",description:"Course summary of Generative AI with Large Language Models. Part One.",section:"Posts",handler:()=>{window.location.href="/blog/2025/gen-ai-llm-1/"}},{id:"post-predicting-u-s-soybean-yield-with-climate-data",title:"Predicting U.S. Soybean Yield with Climate Data",description:"An end-to-end machine learning project on U.S. soybean yield prediction",section:"Posts",handler:()=>{window.location.href="/blog/2025/us-soybean-prediction/"}},{id:"post-statistical-learning-notes-outline",title:"Statistical Learning Notes Outline",description:"Outline of notes about statistical learning.",section:"Posts",handler:()=>{window.location.href="/blog/2023/sl-notes-outline/"}},{id:"post-statistics-and-climate-journal-club",title:"Statistics and Climate Journal Club",description:"Archived topics discussed in the Statistics and Climate Journal Club at UCLA.",section:"Posts",handler:()=>{window.location.href="/blog/2022/stats-climate-journalclub/"}},{id:"news-a-simple-inline-announcement",title:"A simple inline announcement.",description:"",section:"News"},{id:"news-a-long-announcement-with-details",title:"A long announcement with details",description:"",section:"News",handler:()=>{window.location.href="/news/announcement_2/"}},{id:"news-a-simple-inline-announcement-with-markdown-emoji-sparkles-smile",title:'A simple inline announcement with Markdown emoji! <img class="emoji" title=":sparkles:" alt=":sparkles:" src="https://github.githubassets.com/images/icons/emoji/unicode/2728.png" height="20" width="20"> <img class="emoji" title=":smile:" alt=":smile:" src="https://github.githubassets.com/images/icons/emoji/unicode/1f604.png" height="20" width="20">',description:"",section:"News"},{id:"projects-project-1",title:"project 1",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/1_project/"}},{id:"projects-project-2",title:"project 2",description:"a project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/2_project/"}},{id:"projects-project-3-with-very-long-name",title:"project 3 with very long name",description:"a project that redirects to another website",section:"Projects",handler:()=>{window.location.href="/projects/3_project/"}},{id:"projects-project-4",title:"project 4",description:"another without an image",section:"Projects",handler:()=>{window.location.href="/projects/4_project/"}},{id:"projects-project-5",title:"project 5",description:"a project with a background image",section:"Projects",handler:()=>{window.location.href="/projects/5_project/"}},{id:"projects-project-6",title:"project 6",description:"a project with no image",section:"Projects",handler:()=>{window.location.href="/projects/6_project/"}},{id:"projects-project-7",title:"project 7",description:"with background image",section:"Projects",handler:()=>{window.location.href="/projects/7_project/"}},{id:"projects-project-8",title:"project 8",description:"an other project with a background image and giscus comments",section:"Projects",handler:()=>{window.location.href="/projects/8_project/"}},{id:"projects-project-9",title:"project 9",description:"another project with an image \ud83c\udf89",section:"Projects",handler:()=>{window.location.href="/projects/9_project/"}},{id:"socials-google-scholar",title:"Google Scholar",section:"Socials",handler:()=>{window.open("https://scholar.google.com/citations?user=UDAPrT8AAAAJ","_blank")}},{id:"socials-publons",title:"Publons",section:"Socials",handler:()=>{window.open("https://publons.com/a/Y-8516-2019/","_blank")}},{id:"socials-github",title:"GitHub",section:"Socials",handler:()=>{window.open("https://github.com/wenwenkong","_blank")}},{id:"socials-linkedin",title:"LinkedIn",section:"Socials",handler:()=>{window.open("https://www.linkedin.com/in/wenwenkong","_blank")}},{id:"socials-rss",title:"RSS Feed",section:"Socials",handler:()=>{window.open("/feed.xml","_blank")}},{id:"light-theme",title:"Change theme to light",description:"Change the theme of the site to Light",section:"Theme",handler:()=>{setThemeSetting("light")}},{id:"dark-theme",title:"Change theme to dark",description:"Change the theme of the site to Dark",section:"Theme",handler:()=>{setThemeSetting("dark")}},{id:"system-theme",title:"Use system default theme",description:"Change the theme of the site to System Default",section:"Theme",handler:()=>{setThemeSetting("system")}}];</script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>